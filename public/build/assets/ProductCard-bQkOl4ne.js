import{j as e}from"./app-BUOi14ad.js";import{g as t,r as o}from"./vendor-react-BM9Z6hcK.js";import{a as r,x as n}from"./vendor-inertia-yxwOxg76.js";import{S as i,P as a,N as s,a as c}from"./pagination-R5sLhZiN.js";import{u as l}from"./useStore-B7MQNa4k.js";import{g as d,a as h}from"./imageHelper-Mbc89JsA.js";var p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)};var u=function(){return u=Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++)for(var n in t=arguments[o])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},u.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var g,m,f,v,x,w,y,b,C,S,z,j,R,N,D,P=!1;function M(){if(!P){P=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),o=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(j=/\b(iPhone|iP[ao]d)/.exec(e),R=/\b(iP[ao]d)/.exec(e),S=/Android/i.exec(e),N=/FBAN\/\w+;/i.exec(e),D=/Mobile/i.exec(e),z=!!/Win64/.exec(e),t){(g=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(g=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(e);w=r?parseFloat(r[1])+4:g,m=t[2]?parseFloat(t[2]):NaN,f=t[3]?parseFloat(t[3]):NaN,(v=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),x=t&&t[1]?parseFloat(t[1]):NaN):x=NaN}else g=m=f=x=v=NaN;if(o){if(o[1]){var n=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);y=!n||parseFloat(n[1].replace("_","."))}else y=!1;b=!!o[2],C=!!o[3]}else y=b=C=!1}}var k,E={ie:function(){return M()||g},ieCompatibilityMode:function(){return M()||w>g},ie64:function(){return E.ie()&&z},firefox:function(){return M()||m},opera:function(){return M()||f},webkit:function(){return M()||v},safari:function(){return E.webkit()},chrome:function(){return M()||x},windows:function(){return M()||b},osx:function(){return M()||y},linux:function(){return M()||C},iphone:function(){return M()||j},mobile:function(){return M()||j||R||S||D},nativeApp:function(){return M()||N},android:function(){return M()||S},ipad:function(){return M()||R}},_=E,A={canUseDOM:!("undefined"==typeof window||!window.document||!window.document.createElement)};A.canUseDOM&&(k=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""))
/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */;var L=_,W=function(e,t){if(!A.canUseDOM||t&&!("addEventListener"in document))return!1;var o="on"+e,r=o in document;if(!r){var n=document.createElement("div");n.setAttribute(o,"return;"),r="function"==typeof n[o]}return!r&&k&&"wheel"===e&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r};function T(e){var t=0,o=0,r=0,n=0;return"detail"in e&&(o=e.detail),"wheelDelta"in e&&(o=-e.wheelDelta/120),"wheelDeltaY"in e&&(o=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=o,o=0),r=10*t,n=10*o,"deltaY"in e&&(n=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||n)&&e.deltaMode&&(1==e.deltaMode?(r*=40,n*=40):(r*=800,n*=800)),r&&!t&&(t=r<1?-1:1),n&&!o&&(o=n<1?-1:1),{spinX:t,spinY:o,pixelX:r,pixelY:n}}T.getEventType=function(){return L.firefox()?"DOMMouseScroll":W("wheel")?"wheel":"mousewheel"};const O=t(T);function F(e,t,o,r,n){void 0===n&&(n=0);var i=V(t.width,t.height,n),a=i.width,s=i.height;return{x:I(e.x,a,o.width,r),y:I(e.y,s,o.height,r)}}function I(e,t,o,r){var n=t*r/2-o/2;return X(e,-n,n)}function Z(e,t){return Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(e.x-t.x,2))}function H(e,t){return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI}function U(e,t){return Math.min(e,Math.max(0,t))}function B(e,t){return t}function G(e,t){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function V(e,t,o){var r=o*Math.PI/180;return{width:Math.abs(Math.cos(r)*e)+Math.abs(Math.sin(r)*t),height:Math.abs(Math.sin(r)*e)+Math.abs(Math.cos(r)*t)}}function X(e,t,o){return Math.min(Math.max(e,t),o)}function Y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return"string"==typeof e&&e.length>0}).join(" ").trim()}var q=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r.cropperRef=o.createRef(),r.imageRef=o.createRef(),r.videoRef=o.createRef(),r.containerPosition={x:0,y:0},r.containerRef=null,r.styleRef=null,r.containerRect=null,r.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},r.dragStartPosition={x:0,y:0},r.dragStartCrop={x:0,y:0},r.gestureZoomStart=0,r.gestureRotationStart=0,r.isTouching=!1,r.lastPinchDistance=0,r.lastPinchRotation=0,r.rafDragTimeout=null,r.rafPinchTimeout=null,r.wheelTimer=null,r.currentDoc="undefined"!=typeof document?document:null,r.currentWindow="undefined"!=typeof window?window:null,r.resizeObserver=null,r.previousCropSize=null,r.isInitialized=!1,r.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},r.initResizeObserver=function(){if(void 0!==window.ResizeObserver&&r.containerRef){var e=!0;r.resizeObserver=new window.ResizeObserver(function(t){e?e=!1:r.computeSizes()}),r.resizeObserver.observe(r.containerRef)}},r.preventZoomSafari=function(e){return e.preventDefault()},r.cleanEvents=function(){r.currentDoc&&(r.currentDoc.removeEventListener("mousemove",r.onMouseMove),r.currentDoc.removeEventListener("mouseup",r.onDragStopped),r.currentDoc.removeEventListener("touchmove",r.onTouchMove),r.currentDoc.removeEventListener("touchend",r.onDragStopped),r.currentDoc.removeEventListener("gesturechange",r.onGestureChange),r.currentDoc.removeEventListener("gestureend",r.onGestureEnd),r.currentDoc.removeEventListener("scroll",r.onScroll))},r.clearScrollEvent=function(){r.containerRef&&r.containerRef.removeEventListener("wheel",r.onWheel),r.wheelTimer&&clearTimeout(r.wheelTimer)},r.onMediaLoad=function(){var e=r.computeSizes();e&&(r.previousCropSize=e,r.emitCropData(),r.setInitialCrop(e),r.isInitialized=!0),r.props.onMediaLoaded&&r.props.onMediaLoaded(r.mediaSize)},r.setInitialCrop=function(e){if(r.props.initialCroppedAreaPercentages){var t=function(e,t,o,r,n,i){var a=V(t.width,t.height,o),s=X(r.width/a.width*(100/e.width),n,i);return{crop:{x:s*a.width/2-r.width/2-a.width*s*(e.x/100),y:s*a.height/2-r.height/2-a.height*s*(e.y/100)},zoom:s}}(r.props.initialCroppedAreaPercentages,r.mediaSize,r.props.rotation,e,r.props.minZoom,r.props.maxZoom),o=t.crop,n=t.zoom;r.props.onCropChange(o),r.props.onZoomChange&&r.props.onZoomChange(n)}else if(r.props.initialCroppedAreaPixels){var i=function(e,t,o,r,n,i){void 0===o&&(o=0);var a=V(t.naturalWidth,t.naturalHeight,o),s=X(function(e,t,o){var r=function(e){return e.width>e.height?e.width/e.naturalWidth:e.height/e.naturalHeight}(t);return o.height>o.width?o.height/(e.height*r):o.width/(e.width*r)}(e,t,r),n,i),c=r.height>r.width?r.height/e.height:r.width/e.width;return{crop:{x:((a.width-e.width)/2-e.x)*c,y:((a.height-e.height)/2-e.y)*c},zoom:s}}(r.props.initialCroppedAreaPixels,r.mediaSize,r.props.rotation,e,r.props.minZoom,r.props.maxZoom);o=i.crop,n=i.zoom;r.props.onCropChange(o),r.props.onZoomChange&&r.props.onZoomChange(n)}},r.computeSizes=function(){var e,t,o,n,i,a,s=r.imageRef.current||r.videoRef.current;if(s&&r.containerRef){r.containerRect=r.containerRef.getBoundingClientRect(),r.saveContainerPosition();var c=r.containerRect.width/r.containerRect.height,l=(null===(e=r.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=r.videoRef.current)||void 0===t?void 0:t.videoWidth)||0,d=(null===(o=r.imageRef.current)||void 0===o?void 0:o.naturalHeight)||(null===(n=r.videoRef.current)||void 0===n?void 0:n.videoHeight)||0,h=l/d,p=void 0;if(s.offsetWidth<l||s.offsetHeight<d)switch(r.state.mediaObjectFit){default:case"contain":p=c>h?{width:r.containerRect.height*h,height:r.containerRect.height}:{width:r.containerRect.width,height:r.containerRect.width/h};break;case"horizontal-cover":p={width:r.containerRect.width,height:r.containerRect.width/h};break;case"vertical-cover":p={width:r.containerRect.height*h,height:r.containerRect.height}}else p={width:s.offsetWidth,height:s.offsetHeight};r.mediaSize=u(u({},p),{naturalWidth:l,naturalHeight:d}),r.props.setMediaSize&&r.props.setMediaSize(r.mediaSize);var g=r.props.cropSize?r.props.cropSize:function(e,t,o,r,n,i){void 0===i&&(i=0);var a=V(e,t,i),s=a.width,c=a.height,l=Math.min(s,o),d=Math.min(c,r);return l>d*n?{width:d*n,height:d}:{width:l,height:l/n}}(r.mediaSize.width,r.mediaSize.height,r.containerRect.width,r.containerRect.height,r.props.aspect,r.props.rotation);return(null===(i=r.state.cropSize)||void 0===i?void 0:i.height)===g.height&&(null===(a=r.state.cropSize)||void 0===a?void 0:a.width)===g.width||r.props.onCropSizeChange&&r.props.onCropSizeChange(g),r.setState({cropSize:g},r.recomputeCropPosition),r.props.setCropSize&&r.props.setCropSize(g),g}},r.saveContainerPosition=function(){if(r.containerRef){var e=r.containerRef.getBoundingClientRect();r.containerPosition={x:e.left,y:e.top}}},r.onMouseDown=function(e){r.currentDoc&&(e.preventDefault(),r.currentDoc.addEventListener("mousemove",r.onMouseMove),r.currentDoc.addEventListener("mouseup",r.onDragStopped),r.saveContainerPosition(),r.onDragStart(t.getMousePoint(e)))},r.onMouseMove=function(e){return r.onDrag(t.getMousePoint(e))},r.onScroll=function(e){r.currentDoc&&(e.preventDefault(),r.saveContainerPosition())},r.onTouchStart=function(e){r.currentDoc&&(r.isTouching=!0,r.props.onTouchRequest&&!r.props.onTouchRequest(e)||(r.currentDoc.addEventListener("touchmove",r.onTouchMove,{passive:!1}),r.currentDoc.addEventListener("touchend",r.onDragStopped),r.saveContainerPosition(),2===e.touches.length?r.onPinchStart(e):1===e.touches.length&&r.onDragStart(t.getTouchPoint(e.touches[0]))))},r.onTouchMove=function(e){e.preventDefault(),2===e.touches.length?r.onPinchMove(e):1===e.touches.length&&r.onDrag(t.getTouchPoint(e.touches[0]))},r.onGestureStart=function(e){r.currentDoc&&(e.preventDefault(),r.currentDoc.addEventListener("gesturechange",r.onGestureChange),r.currentDoc.addEventListener("gestureend",r.onGestureEnd),r.gestureZoomStart=r.props.zoom,r.gestureRotationStart=r.props.rotation)},r.onGestureChange=function(e){if(e.preventDefault(),!r.isTouching){var o=t.getMousePoint(e),n=r.gestureZoomStart-1+e.scale;if(r.setNewZoom(n,o,{shouldUpdatePosition:!0}),r.props.onRotationChange){var i=r.gestureRotationStart+e.rotation;r.props.onRotationChange(i)}}},r.onGestureEnd=function(e){r.cleanEvents()},r.onDragStart=function(e){var t,o,n=e.x,i=e.y;r.dragStartPosition={x:n,y:i},r.dragStartCrop=u({},r.props.crop),null===(o=(t=r.props).onInteractionStart)||void 0===o||o.call(t)},r.onDrag=function(e){var t=e.x,o=e.y;r.currentWindow&&(r.rafDragTimeout&&r.currentWindow.cancelAnimationFrame(r.rafDragTimeout),r.rafDragTimeout=r.currentWindow.requestAnimationFrame(function(){if(r.state.cropSize&&void 0!==t&&void 0!==o){var e=t-r.dragStartPosition.x,n=o-r.dragStartPosition.y,i={x:r.dragStartCrop.x+e,y:r.dragStartCrop.y+n},a=r.props.restrictPosition?F(i,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):i;r.props.onCropChange(a)}}))},r.onDragStopped=function(){var e,t;r.isTouching=!1,r.cleanEvents(),r.emitCropData(),null===(t=(e=r.props).onInteractionEnd)||void 0===t||t.call(e)},r.onWheel=function(e){if(r.currentWindow&&(!r.props.onWheelRequest||r.props.onWheelRequest(e))){e.preventDefault();var o=t.getMousePoint(e),n=O(e).pixelY,i=r.props.zoom-n*r.props.zoomSpeed/200;r.setNewZoom(i,o,{shouldUpdatePosition:!0}),r.state.hasWheelJustStarted||r.setState({hasWheelJustStarted:!0},function(){var e,t;return null===(t=(e=r.props).onInteractionStart)||void 0===t?void 0:t.call(e)}),r.wheelTimer&&clearTimeout(r.wheelTimer),r.wheelTimer=r.currentWindow.setTimeout(function(){return r.setState({hasWheelJustStarted:!1},function(){var e,t;return null===(t=(e=r.props).onInteractionEnd)||void 0===t?void 0:t.call(e)})},250)}},r.getPointOnContainer=function(e,t){var o=e.x,n=e.y;if(!r.containerRect)throw new Error("The Cropper is not mounted");return{x:r.containerRect.width/2-(o-t.x),y:r.containerRect.height/2-(n-t.y)}},r.getPointOnMedia=function(e){var t=e.x,o=e.y,n=r.props,i=n.crop,a=n.zoom;return{x:(t+i.x)/a,y:(o+i.y)/a}},r.setNewZoom=function(e,t,o){var n=(void 0===o?{}:o).shouldUpdatePosition,i=void 0===n||n;if(r.state.cropSize&&r.props.onZoomChange){var a=X(e,r.props.minZoom,r.props.maxZoom);if(i){var s=r.getPointOnContainer(t,r.containerPosition),c=r.getPointOnMedia(s),l={x:c.x*a-s.x,y:c.y*a-s.y},d=r.props.restrictPosition?F(l,r.mediaSize,r.state.cropSize,a,r.props.rotation):l;r.props.onCropChange(d)}r.props.onZoomChange(a)}},r.getCropData=function(){return r.state.cropSize?function(e,t,o,r,n,i,a){void 0===i&&(i=0),void 0===a&&(a=!0);var s=a?U:B,c=V(t.width,t.height,i),l=V(t.naturalWidth,t.naturalHeight,i),d={x:s(100,((c.width-o.width/n)/2-e.x/n)/c.width*100),y:s(100,((c.height-o.height/n)/2-e.y/n)/c.height*100),width:s(100,o.width/c.width*100/n),height:s(100,o.height/c.height*100/n)},h=Math.round(s(l.width,d.width*l.width/100)),p=Math.round(s(l.height,d.height*l.height/100)),g=l.width>=l.height*r?{width:Math.round(p*r),height:p}:{width:h,height:Math.round(h/r)};return{croppedAreaPercentages:d,croppedAreaPixels:u(u({},g),{x:Math.round(s(l.width-g.width,d.x*l.width/100)),y:Math.round(s(l.height-g.height,d.y*l.height/100))})}}(r.props.restrictPosition?F(r.props.crop,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):r.props.crop,r.mediaSize,r.state.cropSize,r.getAspect(),r.props.zoom,r.props.rotation,r.props.restrictPosition):null},r.emitCropData=function(){var e=r.getCropData();if(e){var t=e.croppedAreaPercentages,o=e.croppedAreaPixels;r.props.onCropComplete&&r.props.onCropComplete(t,o),r.props.onCropAreaChange&&r.props.onCropAreaChange(t,o)}},r.emitCropAreaChange=function(){var e=r.getCropData();if(e){var t=e.croppedAreaPercentages,o=e.croppedAreaPixels;r.props.onCropAreaChange&&r.props.onCropAreaChange(t,o)}},r.recomputeCropPosition=function(){var e,t;if(r.state.cropSize){var o=r.props.crop;if(r.isInitialized&&(null===(e=r.previousCropSize)||void 0===e?void 0:e.width)&&(null===(t=r.previousCropSize)||void 0===t?void 0:t.height))if(Math.abs(r.previousCropSize.width-r.state.cropSize.width)>1e-6||Math.abs(r.previousCropSize.height-r.state.cropSize.height)>1e-6){var n=r.state.cropSize.width/r.previousCropSize.width,i=r.state.cropSize.height/r.previousCropSize.height;o={x:r.props.crop.x*n,y:r.props.crop.y*i}}var a=r.props.restrictPosition?F(o,r.mediaSize,r.state.cropSize,r.props.zoom,r.props.rotation):o;r.previousCropSize=r.state.cropSize,r.props.onCropChange(a),r.emitCropData()}},r.onKeyDown=function(e){var t,o,n=r.props,i=n.crop,a=n.onCropChange,s=n.keyboardStep,c=n.zoom,l=n.rotation,d=s;if(r.state.cropSize){e.shiftKey&&(d*=.2);var h=u({},i);switch(e.key){case"ArrowUp":h.y-=d,e.preventDefault();break;case"ArrowDown":h.y+=d,e.preventDefault();break;case"ArrowLeft":h.x-=d,e.preventDefault();break;case"ArrowRight":h.x+=d,e.preventDefault();break;default:return}r.props.restrictPosition&&(h=F(h,r.mediaSize,r.state.cropSize,c,l)),e.repeat||null===(o=(t=r.props).onInteractionStart)||void 0===o||o.call(t),a(h)}},r.onKeyUp=function(e){var t,o;switch(e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":e.preventDefault();break;default:return}r.emitCropData(),null===(o=(t=r.props).onInteractionEnd)||void 0===o||o.call(t)},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(t,e),t.prototype.componentDidMount=function(){this.currentDoc&&this.currentWindow&&(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),void 0===window.ResizeObserver&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=".reactEasyCrop_Container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n  user-select: none;\n  touch-action: none;\n  cursor: move;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.reactEasyCrop_Image,\n.reactEasyCrop_Video {\n  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */\n}\n\n.reactEasyCrop_Contain {\n  max-width: 100%;\n  max-height: 100%;\n  margin: auto;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n.reactEasyCrop_Cover_Horizontal {\n  width: 100%;\n  height: auto;\n}\n.reactEasyCrop_Cover_Vertical {\n  width: auto;\n  height: 100%;\n}\n\n.reactEasyCrop_CropArea {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  box-sizing: border-box;\n  box-shadow: 0 0 0 9999em;\n  color: rgba(0, 0, 0, 0.5);\n  overflow: hidden;\n}\n\n.reactEasyCrop_CropAreaRound {\n  border-radius: 50%;\n}\n\n.reactEasyCrop_CropAreaGrid::before {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 0;\n  bottom: 0;\n  left: 33.33%;\n  right: 33.33%;\n  border-top: 0;\n  border-bottom: 0;\n}\n\n.reactEasyCrop_CropAreaGrid::after {\n  content: ' ';\n  box-sizing: border-box;\n  position: absolute;\n  border: 1px solid rgba(255, 255, 255, 0.5);\n  top: 33.33%;\n  bottom: 33.33%;\n  left: 0;\n  right: 0;\n  border-left: 0;\n  border-right: 0;\n}\n",this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},t.prototype.componentWillUnmount=function(){var e,t;this.currentDoc&&this.currentWindow&&(void 0===window.ResizeObserver&&this.currentWindow.removeEventListener("resize",this.computeSizes),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&(null===(t=this.styleRef.parentNode)||void 0===t||t.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},t.prototype.componentDidUpdate=function(e){var t,o,r,n,i,a,s,c,l;e.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):e.aspect!==this.props.aspect||e.objectFit!==this.props.objectFit?this.computeSizes():e.zoom!==this.props.zoom?this.recomputeCropPosition():(null===(t=e.cropSize)||void 0===t?void 0:t.height)!==(null===(o=this.props.cropSize)||void 0===o?void 0:o.height)||(null===(r=e.cropSize)||void 0===r?void 0:r.width)!==(null===(n=this.props.cropSize)||void 0===n?void 0:n.width)?this.computeSizes():(null===(i=e.crop)||void 0===i?void 0:i.x)===(null===(a=this.props.crop)||void 0===a?void 0:a.x)&&(null===(s=e.crop)||void 0===s?void 0:s.y)===(null===(c=this.props.crop)||void 0===c?void 0:c.y)||this.emitCropAreaChange(),e.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),e.video!==this.props.video&&(null===(l=this.videoRef.current)||void 0===l||l.load());var d=this.getObjectFit();d!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:d},this.computeSizes)},t.prototype.getAspect=function(){var e=this.props,t=e.cropSize,o=e.aspect;return t?t.width/t.height:o},t.prototype.getObjectFit=function(){var e,t,o,r;if("cover"===this.props.objectFit){if((this.imageRef.current||this.videoRef.current)&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var n=this.containerRect.width/this.containerRect.height;return((null===(e=this.imageRef.current)||void 0===e?void 0:e.naturalWidth)||(null===(t=this.videoRef.current)||void 0===t?void 0:t.videoWidth)||0)/((null===(o=this.imageRef.current)||void 0===o?void 0:o.naturalHeight)||(null===(r=this.videoRef.current)||void 0===r?void 0:r.videoHeight)||0)<n?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},t.prototype.onPinchStart=function(e){var o=t.getTouchPoint(e.touches[0]),r=t.getTouchPoint(e.touches[1]);this.lastPinchDistance=Z(o,r),this.lastPinchRotation=H(o,r),this.onDragStart(G(o,r))},t.prototype.onPinchMove=function(e){var o=this;if(this.currentDoc&&this.currentWindow){var r=t.getTouchPoint(e.touches[0]),n=t.getTouchPoint(e.touches[1]),i=G(r,n);this.onDrag(i),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var e=Z(r,n),t=o.props.zoom*(e/o.lastPinchDistance);o.setNewZoom(t,i,{shouldUpdatePosition:!1}),o.lastPinchDistance=e;var a=H(r,n),s=o.props.rotation+(a-o.lastPinchRotation);o.props.onRotationChange&&o.props.onRotationChange(s),o.lastPinchRotation=a})}},t.prototype.render=function(){var e,t=this,r=this.props,n=r.image,i=r.video,a=r.mediaProps,s=r.cropperProps,c=r.transform,l=r.crop,d=l.x,h=l.y,p=r.rotation,g=r.zoom,m=r.cropShape,f=r.showGrid,v=r.roundCropAreaPixels,x=r.style,w=x.containerStyle,y=x.cropAreaStyle,b=x.mediaStyle,C=r.classes,S=C.containerClassName,z=C.cropAreaClassName,j=C.mediaClassName,R=null!==(e=this.state.mediaObjectFit)&&void 0!==e?e:this.getObjectFit();return o.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(e){return t.containerRef=e},"data-testid":"container",style:w,className:Y("reactEasyCrop_Container",S)},n?o.createElement("img",u({alt:"",className:Y("reactEasyCrop_Image","contain"===R&&"reactEasyCrop_Contain","horizontal-cover"===R&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===R&&"reactEasyCrop_Cover_Vertical",j)},a,{src:n,ref:this.imageRef,style:u(u({},b),{transform:c||"translate(".concat(d,"px, ").concat(h,"px) rotate(").concat(p,"deg) scale(").concat(g,")")}),onLoad:this.onMediaLoad})):i&&o.createElement("video",u({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Y("reactEasyCrop_Video","contain"===R&&"reactEasyCrop_Contain","horizontal-cover"===R&&"reactEasyCrop_Cover_Horizontal","vertical-cover"===R&&"reactEasyCrop_Cover_Vertical",j)},a,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:u(u({},b),{transform:c||"translate(".concat(d,"px, ").concat(h,"px) rotate(").concat(p,"deg) scale(").concat(g,")")}),controls:!1}),(Array.isArray(i)?i:[{src:i}]).map(function(e){return o.createElement("source",u({key:e.src},e))})),this.state.cropSize&&o.createElement("div",u({ref:this.cropperRef,style:u(u({},y),{width:v?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:v?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Y("reactEasyCrop_CropArea","round"===m&&"reactEasyCrop_CropAreaRound",f&&"reactEasyCrop_CropAreaGrid",z)},s)))},t.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:3,minZoom:1,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:1},t.getMousePoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},t.getTouchPoint=function(e){return{x:Number(e.clientX),y:Number(e.clientY)}},t}(o.Component);const K=({isOpen:t,onClose:n,imageUrl:i,categoryId:a,categorySlug:s})=>{const[c,l]=o.useState({x:0,y:0}),[d,h]=o.useState(1),[p,u]=o.useState(null),[g,m]=o.useState(!1),[f,v]=o.useState(null),[x,w]=o.useState(""),y=o.useCallback((e,t)=>{u(t)},[]),b=()=>{n(),v(null),l({x:0,y:0}),h(1)};return t?e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80 backdrop-blur-sm",onClick:b,children:e.jsxs("div",{className:"bg-gray-900 rounded-2xl shadow-2xl max-w-lg w-full mx-4 overflow-hidden",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:"Выбор области иконки"}),e.jsx("button",{onClick:b,className:"w-8 h-8 rounded-lg bg-gray-800 hover:bg-gray-700 flex items-center justify-center transition-colors",children:e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"relative h-80 bg-white",children:e.jsx(q,{image:i,crop:c,zoom:d,minZoom:.3,maxZoom:3,aspect:1,onCropChange:l,onCropComplete:y,onZoomChange:h,cropShape:"rect",showGrid:!0,restrictPosition:!1,style:{containerStyle:{background:"#ffffff"},cropAreaStyle:{border:"2px solid #ef4444"},mediaStyle:{background:"#ffffff"}}})}),e.jsxs("div",{className:"p-4 border-t border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})}),e.jsx("input",{type:"range",min:.3,max:3,step:.05,value:d,onChange:e=>h(Number(e.target.value)),className:"flex-1 h-2 bg-gray-700 rounded-full appearance-none cursor-pointer accent-red-500"}),e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v6m3-3H7"})})]}),e.jsx("p",{className:"text-center text-xs text-gray-500 mt-2",children:"Перетащите изображение и используйте слайдер для масштабирования"})]}),f&&e.jsxs("div",{className:"mx-4 mb-4 p-3 rounded-lg text-sm font-medium text-center "+("success"===f?"bg-green-900/50 text-green-400 border border-green-800":"bg-red-900/50 text-red-400 border border-red-800"),children:["success"===f?"✓ ":"✕ ",x]}),e.jsxs("div",{className:"p-4 border-t border-gray-800 flex gap-3",children:[e.jsx("button",{onClick:b,className:"flex-1 py-3 px-4 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl font-medium transition-colors",children:"Отмена"}),e.jsx("button",{onClick:async()=>{var e,t;if(p){m(!0),v(null);try{const e=await r.post("/api/category/set-icon",{image_url:i,crop_data:p,zoom_level:d,category_id:a||null,category_slug:s||null});e.data.success&&(v("success"),w(e.data.message),setTimeout(()=>{n(),v(null),l({x:0,y:0}),h(1)},1500))}catch(o){v("error"),w((null==(t=null==(e=o.response)?void 0:e.data)?void 0:t.message)||"Произошла ошибка")}finally{m(!1)}}},disabled:g||!p,className:"flex-1 py-3 px-4 bg-red-500 hover:bg-red-600 text-white rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:g?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),"Установить иконку"]})})]})]})}):null},$=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),J=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("circle",{cx:"8",cy:"21",r:"1"}),e.jsx("circle",{cx:"19",cy:"21",r:"1"}),e.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),Q=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:e.jsx("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})}),ee=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"}),e.jsx("circle",{cx:"12",cy:"13",r:"3"})]}),te=({product:t,filters:p={}})=>{const u=l(e=>e.addToCart),g=l(e=>e.incrementCartQuantity),m=l(e=>e.decrementCartQuantity),f=l(e=>e.toggleFavorite),v=l(e=>e.favorites),x=e=>v.some(t=>t.id===e),w=l(e=>e.toggleChatQueue),y=l(e=>e.cart),b=l(e=>e.chatQueue),[C,S]=o.useState(!1),[z,j]=o.useState(null);o.useRef(null);const[R,N]=o.useState(t.key_benefits||null),[D,P]=o.useState(!1),[M,k]=o.useState(!!t.key_benefits),E=(()=>{if("undefined"==typeof window)return!1;const e=new URLSearchParams(window.location.search).get("edit_icons");return"1"===e?(localStorage.setItem("edit_icons_mode","1"),!0):"0"===e?(localStorage.removeItem("edit_icons_mode"),!1):"1"===localStorage.getItem("edit_icons_mode")})(),_=e=>{e.preventDefault(),e.stopPropagation(),t.stock>0&&u(t)},A=e=>{e.preventDefault(),e.stopPropagation(),w(t)},L=[t.image_main,...(t.additional_images||[]).map(e=>e.url)].filter(Boolean);0===L.length&&L.push("https://placehold.co/400x400/e5e7eb/6b7280?text=No+Image");const W=(()=>{const e=new URLSearchParams;p.category&&e.set("category",p.category),p.sub_category&&e.set("sub_category",p.sub_category),p.brand&&e.set("brand",p.brand),p.search&&e.set("search",p.search),p.sort&&e.set("sort",p.sort);const o=e.toString();return`/product/${t.slug}${o?"?"+o:""}`})();return e.jsxs(e.Fragment,{children:[e.jsxs(n,{href:W,className:"bg-white rounded-2xl overflow-hidden shadow-sm group border border-gray-100 flex flex-col cursor-pointer hover:shadow-md transition-shadow relative",onMouseEnter:()=>{R||D||M||(P(!0),r.get(`/api/products/${t.slug}/benefits`).then(e=>{N(e.data.benefits),k(!0)}).catch(e=>{}).finally(()=>{P(!1)}))},children:[e.jsxs("div",{className:"relative aspect-[2/3] overflow-hidden bg-gray-50",children:[e.jsx(i,{modules:[a,s],pagination:{clickable:!0},navigation:!0,className:"h-full w-full product-swiper",children:L.map((o,r)=>e.jsx(c,{children:e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{...d(h(o),`${t.name} - ${r+1}`,{loading:"lazy",width:400,height:600,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"})}),E&&e.jsx("button",{onClick:e=>((e,t)=>{e.preventDefault(),e.stopPropagation(),j(t),S(!0)})(e,o),className:"absolute top-2 right-2 w-8 h-8 bg-black/50 hover:bg-black/70 text-white rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity z-20",title:"Установить как иконку категории",children:e.jsx(ee,{className:"w-4 h-4"})})]})},r))}),t.old_price&&e.jsxs("div",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-lg z-10",children:["-",Math.round((t.old_price-t.price)/t.old_price*100),"%"]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 pointer-events-none z-10 flex flex-col justify-end p-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-lg shadow-lg p-2 transform translate-y-2 group-hover:translate-y-0 transition-transform duration-300 border border-gray-100/50",children:D&&!R?e.jsxs("div",{className:"flex flex-col gap-1.5 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]}):R&&R.length>0?e.jsx("ul",{className:"flex flex-col gap-1",children:R.map((t,o)=>e.jsxs("li",{className:"flex items-start gap-1.5 text-xs text-gray-700 font-medium leading-tight",children:[e.jsx("div",{className:"mt-0.5 w-1 h-1 rounded-full bg-blue-500 shrink-0 shadow-[0_0_4px_rgba(59,130,246,0.5)]"}),e.jsx("span",{children:t})]},o))}):null})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm mb-1 line-clamp-2 min-h-[2.5rem]",children:t.name}),e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-yellow-500 text-sm",children:"★"}),e.jsx("span",{className:"text-xs text-gray-600",children:Number(t.reviews_avg_rating||0).toFixed(1)}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",t.reviews_count||0,")"]})]}),e.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[new Intl.NumberFormat("ru-RU").format(t.price)," BYN"]}),t.old_price&&e.jsxs("span",{className:"text-xs text-gray-400 line-through mb-0.5",children:[new Intl.NumberFormat("ru-RU").format(t.old_price)," BYN"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),f(t)},className:"flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-colors "+(x(t.id)?"bg-red-50 border border-red-200":"bg-gray-100 hover:bg-gray-200"),children:e.jsx($,{className:"w-5 h-5 transition-all "+(x(t.id)?"fill-red-500 stroke-red-500":"text-gray-600")})}),(()=>{const o=y.find(e=>e.id===t.id);return o?e.jsxs("div",{className:"flex-1 flex items-center gap-1 bg-green-600 rounded-xl overflow-hidden",children:[e.jsx("button",{onClick:e=>((e,t)=>{e.preventDefault(),e.stopPropagation(),m(t)})(e,t.id),className:"w-10 h-10 flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"−"}),e.jsx("div",{className:"flex-1 text-center text-white font-bold text-sm",children:o.quantity}),e.jsx("button",{onClick:e=>((e,t)=>{e.preventDefault(),e.stopPropagation(),g(t)})(e,t.id),className:"w-10 h-10 flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"+"})]}):e.jsx("button",{onClick:_,className:"flex-1 py-2.5 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 "+(t.stock<=0?"bg-gray-200 text-gray-500":"bg-red-500 hover:bg-red-600 text-white"),disabled:t.stock<=0,children:t.stock>0?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[e.jsx("span",{className:"xs:hidden",children:"купить"}),e.jsx("span",{className:"hidden xs:inline",children:(new Date).getHours()<19?"сегодня":"завтра"})]})]}):"Нет в наличии"})})(),(()=>{const o=b.some(e=>e.id===t.id);return e.jsx("button",{onClick:A,className:"flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-colors "+(o?"bg-red-50 border border-red-200":"bg-gray-100 hover:bg-gray-200"),children:e.jsx(Q,{className:"w-5 h-5 transition-all "+(o?"fill-red-500 stroke-red-500":"text-gray-600")})})})()]})]})]}),e.jsx(K,{isOpen:C,onClose:()=>S(!1),imageUrl:z,...(()=>{const e=new URLSearchParams(window.location.search).get("sub_category");if(e){const t=e.split(",")[0];return{categoryId:parseInt(t,10),categorySlug:null}}const t=window.location.pathname.match(/\/category\/([^/]+)/);return t?{categoryId:null,categorySlug:t[1]}:{categoryId:null,categorySlug:null}})()})]})};export{te as P};
