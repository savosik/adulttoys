import{r as a,a as q,A as $,j as e,S as P,x as g}from"./app-nMwxjLQ7.js";import{M as Z}from"./MainLayout-BeTs2XOL.js";import{u as l}from"./useStore-DLstr-6t.js";/* empty css            */const o={Trash2:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),e.jsx("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),e.jsx("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]}),ShoppingCart:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("circle",{cx:"8",cy:"21",r:"1"}),e.jsx("circle",{cx:"19",cy:"21",r:"1"}),e.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),ArrowUpDown:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]}),Search:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),Mic:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",x2:"12",y1:"19",y2:"22"})]}),Tag:s=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:[e.jsx("path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"}),e.jsx("path",{d:"M7 7h.01"})]}),Heart:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),MessageCircle:s=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...s,children:e.jsx("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})})},K=()=>{const s=l(t=>t.cart),F=l(t=>t.removeFromCart),D=l(t=>t.incrementCartQuantity),Q=l(t=>t.decrementCartQuantity),k=l(t=>t.getCartTotal()),x=l(t=>t.getCartCount()),T=l(t=>t.clearCart),p=l(t=>t.isFavorite),C=l(t=>t.toggleFavorite),S=l(t=>t.chatQueue),I=l(t=>t.toggleChatQueue),[f,W]=a.useState("latest"),[j,w]=a.useState(!1),b=a.useRef(null),A=[{label:"Сначала новые",value:"latest"},{label:"Дешевле",value:"price_asc"},{label:"Дороже",value:"price_desc"},{label:"По названию (А-Я)",value:"name_asc"},{label:"По названию (Я-А)",value:"name_desc"}],E=[...s].sort((t,r)=>{switch(f){case"price_asc":return t.price-r.price;case"price_desc":return r.price-t.price;case"name_asc":return t.name.localeCompare(r.name);case"name_desc":return r.name.localeCompare(t.name);case"latest":default:return 0}}),[i,L]=a.useState(""),[c,M]=a.useState({products:[],categories:[]}),[H,d]=a.useState(!1),[R,u]=a.useState(!1),[v,y]=a.useState(!1),N=a.useRef(null),n=a.useRef(null);a.useEffect(()=>{const t=r=>{N.current&&!N.current.contains(r.target)&&d(!1),b.current&&!b.current.contains(r.target)&&w(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),a.useEffect(()=>{const t=setTimeout(()=>{i.length>=2?q.get(`/search/suggestions?q=${i}`).then(r=>{M(r.data),d(!0)}):(M({products:[],categories:[]}),d(!1))},300);return()=>clearTimeout(t)},[i]),a.useEffect(()=>{if(typeof window<"u"&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){const t=window.SpeechRecognition||window.webkitSpeechRecognition;n.current=new t,n.current.continuous=!1,n.current.interimResults=!1,n.current.lang="ru-RU",n.current.onresult=r=>{const h=r.results[0][0].transcript;L(h),u(!1),$.get("/catalog",{search:h})},n.current.onerror=()=>u(!1),n.current.onend=()=>u(!1)}return()=>{var t;return(t=n.current)==null?void 0:t.stop()}},[]);const U=t=>L(t.target.value),_=t=>{t==null||t.preventDefault(),i.trim()&&$.get("/catalog",{search:i})},V=()=>{if(!n.current)return alert("Голосовой ввод не поддерживается");R?n.current.stop():(n.current.start(),u(!0))},Y=t=>{W(t),w(!1)},m=t=>new Intl.NumberFormat("ru-RU").format(t);return e.jsxs(Z,{children:[e.jsx(P,{title:"Корзина"}),e.jsxs("div",{className:"bg-white shadow-sm flex-shrink-0 sticky top-0 z-20",children:[e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",ref:N,children:[e.jsxs("form",{onSubmit:_,className:"relative",children:[e.jsx(o.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск товаров...",value:i,onChange:U,onFocus:()=>i.length>=2&&d(!0),className:"w-full pl-9 pr-10 py-2 bg-gray-100 rounded-xl border-0 focus:ring-2 focus:ring-red-400 focus:bg-white transition-all text-sm"}),e.jsx("button",{type:"submit",className:"hidden","aria-hidden":"true"}),e.jsx("button",{type:"button",onClick:V,className:`absolute right-2 top-1/2 -translate-y-1/2 p-1.5 rounded-full transition-all ${R?"bg-red-500 text-white animate-pulse":"text-gray-400 hover:text-red-600 hover:bg-gray-200"}`,children:e.jsx(o.Mic,{className:"w-4 h-4"})})]}),H&&(c.products.length>0||c.categories.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-100 z-[9999] animate-in fade-in slide-in-from-top-2 duration-200 max-h-[70vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"overflow-y-auto flex-1",children:[c.categories.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"px-3 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Категории"}),c.categories.map(t=>e.jsxs(g,{href:t.url,onClick:()=>d(!1),className:"flex items-center gap-3 px-3 py-2 hover:bg-red-50 rounded-lg transition-colors group",children:[t.icon_url?e.jsx("img",{src:t.icon_url,alt:"",className:"w-4 h-4 object-contain flex-shrink-0"}):e.jsx(o.Tag,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.name})]},t.id))]}),c.products.length>0&&e.jsxs("div",{className:"p-2 border-t border-gray-50",children:[e.jsx("div",{className:"px-3 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Товары"}),c.products.map(t=>{const r={id:t.id,name:t.name,price:t.price,image_main:t.image,stock:1},h=p(t.id);return e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 hover:bg-red-50 rounded-lg transition-colors group",children:[e.jsxs(g,{href:t.url,onClick:()=>d(!1),className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-lg overflow-hidden border border-gray-100 flex-shrink-0",children:e.jsx("img",{src:t.image||"https://placehold.co/100x100?text=No+Image",alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsxs("div",{className:"text-xs text-red-600 font-bold",children:[new Intl.NumberFormat("ru-RU").format(t.price)," BYN"]}),t.reviews_count>0&&e.jsxs("div",{className:"flex items-center gap-0.5 text-[10px] text-gray-400",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{children:Number(t.reviews_avg_rating).toFixed(1)}),e.jsxs("span",{children:["(",t.reviews_count,")"]})]})]})]})]}),e.jsx("button",{onClick:B=>{B.preventDefault(),B.stopPropagation(),C(r)},className:`w-8 h-8 rounded-lg flex items-center justify-center transition-colors ${h?"bg-red-50":"bg-gray-100 hover:bg-gray-200"}`,children:e.jsx(o.Heart,{className:`w-4 h-4 ${h?"fill-red-500 text-red-500":"text-gray-600"}`})})]},t.id)})]})]}),e.jsx("button",{onClick:_,className:"w-full p-3 bg-red-50 text-center text-xs font-bold text-red-600 hover:bg-red-100 transition-colors border-t border-gray-100",children:"Показать все результаты"})]})]}),e.jsxs("div",{className:"relative flex-shrink-0",ref:b,children:[e.jsx("button",{onClick:()=>w(!j),className:`p-2 rounded-lg transition-colors ${j?"bg-gray-200":"hover:bg-gray-100"}`,children:e.jsx(o.ArrowUpDown,{className:"w-6 h-6 text-gray-700"})}),j&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 z-50 py-2 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-50 mb-1",children:e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Сортировка"})}),A.map(t=>e.jsxs("button",{onClick:()=>Y(t.value),className:`w-full px-4 py-2.5 text-left text-sm transition-colors flex items-center justify-between ${f===t.value?"text-red-700 font-bold bg-red-50":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx("span",{children:t.label}),f===t.value&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"})]},t.value))]})]})]})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Корзина"}),s.length>0&&e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[x," ",x===1?"товар":x>1&&x<5?"товара":"товаров"]})]}),s.length>0&&e.jsx("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),v?(T(),y(!1)):(y(!0),setTimeout(()=>y(!1),3e3))},className:`text-sm transition-colors font-medium px-3 py-1 rounded-lg ${v?"bg-red-500 text-white hover:bg-red-600":"text-gray-400 hover:text-red-500"}`,children:v?"Уверены? Нажмите ещё раз":"Очистить всё"})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto content-scroll bg-gray-50",children:e.jsx("div",{className:"max-w-4xl mx-auto p-4 md:p-6",children:s.length===0?e.jsxs("div",{className:"bg-white rounded-3xl p-12 text-center shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(o.ShoppingCart,{className:"w-10 h-10 text-gray-300"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Ваша корзина пуста"}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-xs mx-auto",children:"Самое время добавить в неё что-нибудь интересное из нашего каталога"}),e.jsx(g,{href:"/catalog",className:"inline-flex items-center justify-center px-8 py-4 bg-red-500 text-white rounded-2xl font-bold hover:bg-red-600 transition-all shadow-lg shadow-red-500/20 active:scale-95",children:"Перейти к покупкам"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:E.map(t=>e.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex gap-4",children:[e.jsx(g,{href:`/product/${t.id}`,className:"w-24 h-32 bg-gray-50 rounded-xl overflow-hidden flex-shrink-0 border border-gray-100",children:e.jsx("img",{src:t.image_main||"https://placehold.co/400x600?text=No+Image",alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2 mb-2",children:[e.jsx(g,{href:`/product/${t.id}`,className:"font-bold text-gray-900 text-sm hover:text-red-500 transition-colors line-clamp-2",children:t.name}),e.jsx("button",{onClick:()=>F(t.id),className:"p-1.5 text-gray-300 hover:text-red-500 transition-colors rounded-lg hover:bg-red-50",children:e.jsx(o.Trash2,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"mt-auto flex items-end justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"text-lg font-bold text-red-600",children:[m(t.price*t.quantity)," BYN"]}),t.quantity>1&&e.jsxs("div",{className:"text-[10px] text-gray-400 font-medium",children:[m(t.price)," BYN / шт."]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>C(t),className:`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${p(t.id)?"bg-red-50":"bg-gray-100 hover:bg-gray-200"}`,children:e.jsx(o.Heart,{className:`w-5 h-5 ${p(t.id)?"fill-red-500 text-red-500":"text-gray-600"}`})}),e.jsxs("div",{className:"flex items-center gap-1 bg-green-600 rounded-xl overflow-hidden h-10 min-w-[100px]",children:[e.jsx("button",{onClick:()=>Q(t.id),className:"w-8 h-full flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"−"}),e.jsx("div",{className:"flex-1 text-center text-white font-bold text-sm",children:t.quantity}),e.jsx("button",{onClick:()=>D(t.id),className:"w-8 h-full flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"+"})]}),e.jsx("button",{onClick:()=>I(t),className:`w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${S.some(r=>r.id===t.id)?"bg-red-50 border border-red-200":"bg-gray-100 hover:bg-gray-200"}`,children:e.jsx(o.MessageCircle,{className:`w-5 h-5 ${S.some(r=>r.id===t.id)?"fill-red-500 text-red-500":"text-gray-600"}`})})]})]})]})]},t.id))}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 sticky top-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-6",children:"Ваш заказ"}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Товары (",x,")"]}),e.jsxs("span",{className:"font-bold text-gray-900",children:[m(k)," BYN"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Доставка"}),e.jsx("span",{className:"text-green-600 font-bold",children:"Бесплатно"})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 flex justify-between items-end",children:[e.jsx("span",{className:"text-base font-bold text-gray-900",children:"Итого"}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-2xl font-extrabold text-red-600",children:[m(k)," BYN"]})})]})]}),e.jsx("button",{className:"w-full py-4 bg-red-500 text-white rounded-2xl font-bold text-lg hover:bg-red-600 transition-all shadow-lg shadow-red-500/20 active:scale-95 mb-4",children:"Оформить заказ"}),e.jsx("p",{className:"text-[10px] text-gray-400 text-center leading-relaxed",children:"Нажимая кнопку «Оформить заказ», вы соглашаетесь с условиями публичной оферты и политики конфиденциальности"})]})})]})})})]})};export{K as default};
