import{j as e}from"./app-DXCU__9_.js";import{r as t}from"./vendor-react-WQGp0izF.js";import{M as r}from"./MainLayout-_oXDbsa8.js";import{A as s,S as n}from"./vendor-inertia-B685lsGm.js";import{u as o}from"./useStore-I3pEfUML.js";import{P as a}from"./ProductCard-qorHt5rp.js";import"./pagination-BZCQGJQe.js";import"./vendor-swiper-CNwGi3cp.js";import"./imageHelper-Mbc89JsA.js";const i=t=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:e.jsx("path",{d:"m18 15-6-6-6 6"})}),l=t=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),c=r=>{var c,d,m,u,x,g;const{products:p,categories:h,subCategories:j=[],filters:f,currentCategory:v=null,currentBrand:y=null}=r,[b,w]=t.useState((null==p?void 0:p.data)||[]),[N,k]=t.useState(!1),[S,C]=t.useState(!1),[_,L]=t.useState(new Set(f.sub_category?String(f.sub_category).split(","):[]));t.useEffect(()=>{L(new Set(f.sub_category?String(f.sub_category).split(","):[]))},[f.sub_category]);const[E,M]=t.useState(f.search||""),[$,A]=t.useState({products:[],categories:[]}),[B,Q]=t.useState(!1),[R,T]=t.useState(!1);t.useRef(null),t.useRef(null);const W=t.useRef(null),D=t.useRef(null),[I,F]=t.useState(!1);f.sort,o(e=>e.addToCart),o(e=>e.incrementCartQuantity),o(e=>e.decrementCartQuantity),o(e=>e.toggleFavorite),o(e=>e.favorites),o(e=>e.toggleChatQueue),o(e=>e.cart),o(e=>e.chatQueue),t.useEffect(()=>{p&&(1===p.current_page?w(p.data||[]):w(e=>[...e,...p.data||[]]),k(!1))},[p]),t.useEffect(()=>{if(!p)return;const e=new IntersectionObserver(e=>{e[0].isIntersecting&&p.next_page_url&&!N&&(k(!0),s.get(p.next_page_url,{},{preserveState:!0,preserveScroll:!0,only:["products"]}))},{threshold:.1});return W.current&&e.observe(W.current),()=>e.disconnect()},[null==p?void 0:p.next_page_url,N]),t.useEffect(()=>{const e=()=>{if(D.current){const e=D.current.scrollTop;F(e>500)}},t=D.current;if(t)return t.addEventListener("scroll",e),()=>t.removeEventListener("scroll",e)},[]);return e.jsxs(e.Fragment,{children:[e.jsxs(n,{title:(null==(c=r.meta)?void 0:c.title)||"Каталог товаров",children:[e.jsx("meta",{name:"description",content:(null==(d=r.meta)?void 0:d.description)||"Каталог товаров A-toys"}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:title",content:(null==(m=r.meta)?void 0:m.title)||"Каталог товаров"}),e.jsx("meta",{property:"og:description",content:(null==(u=r.meta)?void 0:u.description)||"Каталог товаров A-toys"}),e.jsx("meta",{name:"twitter:card",content:"summary"}),e.jsx("meta",{name:"twitter:title",content:(null==(x=r.meta)?void 0:x.title)||"Каталог товаров"}),e.jsx("meta",{name:"twitter:description",content:(null==(g=r.meta)?void 0:g.description)||"Каталог товаров A-toys"})]}),e.jsxs("main",{ref:D,className:"relative",children:[e.jsxs("div",{className:"p-4",children:[e.jsx("h1",{className:"sr-only",children:v?v.name:y?`Товары бренда ${y.name}`:f.search?`Поиск: ${f.search}`:"Каталог товаров"}),y&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:y.name}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Все товары бренда"})]}),j.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map((t,r)=>{const n=_.has(String(t.id)),o=!S&&r>=5;return e.jsxs("button",{onClick:()=>(e=>{const t=String(e),r=new Set(_);r.has(t)?r.delete(t):r.add(t),L(r);const n=Array.from(r).join(","),o=f.category?`/category/${f.category}`:"/";s.get(o,{...f,category:void 0,sub_category:n||void 0},{preserveState:!0,preserveScroll:!0,replace:!0})})(t.id),className:`px-3 py-1.5 rounded-lg text-[9px] font-bold transition-all border text-left leading-none items-center gap-1.5 break-words flex-shrink-0 max-w-[180px] sm:max-w-none ${o?"hidden":"flex"} ${n?"bg-red-700 text-white border-red-700 shadow-sm":"bg-white border-gray-200 text-gray-500 hover:border-red-300"}`,children:[e.jsx("span",{children:t.name}),n&&e.jsx("svg",{className:"w-2.5 h-2.5 text-white/80",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})]},t.id)})}),j.length>5&&e.jsxs("button",{onClick:()=>C(!S),className:"w-full mt-4 py-2 bg-gray-50/50 rounded-xl text-red-500 text-[10px] font-bold uppercase tracking-widest flex items-center justify-center gap-2 hover:bg-gray-100 hover:text-red-700 transition-all border border-transparent hover:border-gray-200",children:[e.jsx("span",{children:S?"Скрыть лишнее":`Все подкатегории (${j.length})`}),e.jsx("svg",{className:"w-3.5 h-3.5 transition-transform duration-500 "+(S?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]}),b.length>0?e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 3xl:grid-cols-6 gap-4",children:b.map(t=>e.jsx(a,{product:t,filters:f},t.id))}):!N&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(l,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Ничего не найдено"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-xs",children:"Попробуйте изменить запрос или сбросить фильтры"}),e.jsx("button",{onClick:()=>s.get("/"),className:"mt-6 px-6 py-2 bg-red-500 text-white rounded-xl text-sm font-bold hover:bg-red-600 transition-colors",children:"Сбросить все"})]}),e.jsx("div",{ref:W,className:"h-20 flex items-center justify-center mt-4",children:N&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-red-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})}),I&&e.jsx("button",{onClick:()=>{var e;null==(e=D.current)||e.scrollTo({top:0,behavior:"smooth"})},className:"fixed bottom-6 right-6 w-12 h-12 bg-red-500 text-white rounded-full shadow-lg flex items-center justify-center hover:bg-red-600 transition-all z-50",children:e.jsx(i,{className:"w-5 h-5"})})]}),((null==v?void 0:v.description)||(null==y?void 0:y.description))&&e.jsx("div",{className:"bg-gray-50 border-t border-gray-100 mt-12 py-12",children:e.jsx("div",{className:"container mx-auto px-4 max-w-4xl",children:e.jsx("section",{className:"prose prose-red prose-sm sm:prose-base max-w-none text-gray-600",dangerouslySetInnerHTML:{__html:(null==v?void 0:v.description)||(null==y?void 0:y.description)}})})})]})]})};c.layout=t=>e.jsx(r,{children:t,filters:t.props.filters});export{c as default};
