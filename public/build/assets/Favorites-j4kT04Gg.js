import{r as l,a as q,A as L,j as e,S as O,x as u}from"./app-nMwxjLQ7.js";import{M as G}from"./MainLayout-BeTs2XOL.js";import{S as J,P as K,N as X,a as ee}from"./navigation-BtS5dvw2.js";import{u as o}from"./useStore-DLstr-6t.js";/* empty css            */const c={Heart:n=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:e.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})}),ShoppingCart:n=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[e.jsx("circle",{cx:"8",cy:"21",r:"1"}),e.jsx("circle",{cx:"19",cy:"21",r:"1"}),e.jsx("path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"})]}),MessageCircle:n=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:e.jsx("path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z"})}),Search:n=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),Mic:n=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[e.jsx("path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z"}),e.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),e.jsx("line",{x1:"12",x2:"12",y1:"19",y2:"22"})]}),Tag:n=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[e.jsx("path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"}),e.jsx("path",{d:"M7 7h.01"})]}),ArrowUpDown:n=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...n,children:[e.jsx("path",{d:"m21 16-4 4-4-4"}),e.jsx("path",{d:"M17 20V4"}),e.jsx("path",{d:"m3 8 4-4 4 4"}),e.jsx("path",{d:"M7 4v16"})]})},le=()=>{const n=o(t=>t.addToCart),F=o(t=>t.incrementCartQuantity),R=o(t=>t.decrementCartQuantity),N=o(t=>t.toggleFavorite),D=o(t=>t.isFavorite),M=o(t=>t.toggleChatQueue),$=o(t=>t.cart),I=o(t=>t.chatQueue),d=o(t=>t.favorites),B=o(t=>t.clearFavorites),[f,P]=l.useState("latest"),[p,w]=l.useState(!1),j=l.useRef(null),Q=[{label:"Сначала новые",value:"latest"},{label:"Дешевле",value:"price_asc"},{label:"Дороже",value:"price_desc"},{label:"По названию (А-Я)",value:"name_asc"},{label:"По названию (Я-А)",value:"name_desc"}],T=[...d].sort((t,s)=>{switch(f){case"price_asc":return t.price-s.price;case"price_desc":return s.price-t.price;case"name_asc":return t.name.localeCompare(s.name);case"name_desc":return s.name.localeCompare(t.name);case"latest":default:return 0}}),[x,k]=l.useState(""),[h,C]=l.useState({products:[],categories:[]}),[A,g]=l.useState(!1),[S,m]=l.useState(!1),[v,b]=l.useState(!1),y=l.useRef(null),i=l.useRef(null);l.useEffect(()=>{const t=s=>{y.current&&!y.current.contains(s.target)&&g(!1),j.current&&!j.current.contains(s.target)&&w(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]),l.useEffect(()=>{const t=setTimeout(()=>{x.length>=2?q.get(`/search/suggestions?q=${x}`).then(s=>{C(s.data),g(!0)}):(C({products:[],categories:[]}),g(!1))},300);return()=>clearTimeout(t)},[x]),l.useEffect(()=>{if(typeof window<"u"&&("webkitSpeechRecognition"in window||"SpeechRecognition"in window)){const t=window.SpeechRecognition||window.webkitSpeechRecognition;i.current=new t,i.current.continuous=!1,i.current.interimResults=!1,i.current.lang="ru-RU",i.current.onresult=s=>{const r=s.results[0][0].transcript;k(r),m(!1),L.get("/catalog",{search:r})},i.current.onerror=()=>m(!1),i.current.onend=()=>m(!1)}return()=>{var t;return(t=i.current)==null?void 0:t.stop()}},[]);const E=t=>k(t.target.value),_=t=>{t==null||t.preventDefault(),x.trim()&&L.get("/catalog",{search:x})},W=()=>{if(!i.current)return alert("Голосовой ввод не поддерживается");S?i.current.stop():(i.current.start(),m(!0))},H=t=>{P(t),w(!1)},U=(t,s)=>{t.preventDefault(),t.stopPropagation(),s.stock>0&&n(s)},z=(t,s)=>{t.preventDefault(),t.stopPropagation(),F(s)},Z=(t,s)=>{t.preventDefault(),t.stopPropagation(),R(s)},V=(t,s)=>{t.preventDefault(),t.stopPropagation(),N(s)},Y=(t,s)=>{t.preventDefault(),t.stopPropagation(),M(s)};return e.jsxs(G,{children:[e.jsx(O,{title:"Избранное"}),e.jsxs("div",{className:"bg-white shadow-sm flex-shrink-0 sticky top-0 z-20",children:[e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 relative",ref:y,children:[e.jsxs("form",{onSubmit:_,className:"relative",children:[e.jsx(c.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Поиск товаров...",value:x,onChange:E,onFocus:()=>x.length>=2&&g(!0),className:"w-full pl-9 pr-10 py-2 bg-gray-100 rounded-xl border-0 focus:ring-2 focus:ring-red-400 focus:bg-white transition-all text-sm"}),e.jsx("button",{type:"submit",className:"hidden","aria-hidden":"true"}),e.jsx("button",{type:"button",onClick:W,className:`absolute right-2 top-1/2 -translate-y-1/2 p-1.5 rounded-full transition-all ${S?"bg-red-500 text-white animate-pulse":"text-gray-400 hover:text-red-600 hover:bg-gray-200"}`,children:e.jsx(c.Mic,{className:"w-4 h-4"})})]}),A&&(h.products.length>0||h.categories.length>0)&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-100 z-[9999] animate-in fade-in slide-in-from-top-2 duration-200 max-h-[70vh] flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"overflow-y-auto flex-1",children:[h.categories.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsx("div",{className:"px-3 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Категории"}),h.categories.map(t=>e.jsxs(u,{href:t.url,onClick:()=>g(!1),className:"flex items-center gap-3 px-3 py-2 hover:bg-red-50 rounded-lg transition-colors group",children:[t.icon_url?e.jsx("img",{src:t.icon_url,alt:"",className:"w-4 h-4 object-contain flex-shrink-0"}):e.jsx(c.Tag,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:t.name})]},t.id))]}),h.products.length>0&&e.jsxs("div",{className:"p-2 border-t border-gray-50",children:[e.jsx("div",{className:"px-3 py-1 text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Товары"}),h.products.map(t=>{const s={id:t.id,name:t.name,price:t.price,image_main:t.image,stock:1},r=D(t.id);return e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 hover:bg-red-50 rounded-lg transition-colors group",children:[e.jsxs(u,{href:t.url,onClick:()=>g(!1),className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-lg overflow-hidden border border-gray-100 flex-shrink-0",children:e.jsx("img",{src:t.image||"https://placehold.co/100x100?text=No+Image",alt:"",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsxs("div",{className:"text-xs text-red-600 font-bold",children:[new Intl.NumberFormat("ru-RU").format(t.price)," BYN"]}),t.reviews_count>0&&e.jsxs("div",{className:"flex items-center gap-0.5 text-[10px] text-gray-400",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{children:Number(t.reviews_avg_rating).toFixed(1)}),e.jsxs("span",{children:["(",t.reviews_count,")"]})]})]})]})]}),e.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),N(s)},className:`w-8 h-8 rounded-lg flex items-center justify-center transition-colors ${r?"bg-red-50":"bg-gray-100 hover:bg-gray-200"}`,children:e.jsx(c.Heart,{className:`w-4 h-4 ${r?"fill-red-500 text-red-500":"text-gray-600"}`})})]},t.id)})]})]}),e.jsx("button",{onClick:_,className:"w-full p-3 bg-red-50 text-center text-xs font-bold text-red-600 hover:bg-red-100 transition-colors border-t border-gray-100",children:"Показать все результаты"})]})]}),e.jsxs("div",{className:"relative flex-shrink-0",ref:j,children:[e.jsx("button",{onClick:()=>w(!p),className:`p-2 rounded-lg transition-colors ${p?"bg-gray-200":"hover:bg-gray-100"}`,children:e.jsx(c.ArrowUpDown,{className:"w-6 h-6 text-gray-700"})}),p&&e.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 z-50 py-2 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsx("div",{className:"px-4 py-2 border-b border-gray-50 mb-1",children:e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Сортировка"})}),Q.map(t=>e.jsxs("button",{onClick:()=>H(t.value),className:`w-full px-4 py-2.5 text-left text-sm transition-colors flex items-center justify-between ${f===t.value?"text-red-700 font-bold bg-red-50":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx("span",{children:t.label}),f===t.value&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500"})]},t.value))]})]})]})}),e.jsxs("div",{className:"px-4 py-3 border-t border-gray-50 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Избранное"}),d.length>0&&e.jsxs("p",{className:"text-sm text-gray-500 mt-0.5",children:[d.length," ",d.length===1?"товар":d.length>1&&d.length<5?"товара":"товаров"]})]}),d.length>0&&e.jsx("button",{type:"button",onClick:t=>{t.preventDefault(),t.stopPropagation(),v?(B(),b(!1)):(b(!0),setTimeout(()=>b(!1),3e3))},className:`text-sm transition-colors font-medium px-3 py-1 rounded-lg ${v?"bg-red-500 text-white hover:bg-red-600":"text-gray-400 hover:text-red-500"}`,children:v?"Уверены? Нажмите ещё раз":"Очистить всё"})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto content-scroll",children:e.jsx("div",{className:"p-4",children:d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(c.Heart,{className:"w-12 h-12 text-gray-400"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Список избранного пуст"}),e.jsx("p",{className:"text-gray-500 text-center mb-6 max-w-sm",children:"Добавляйте понравившиеся товары, чтобы не потерять их"}),e.jsx(u,{href:"/catalog",className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-medium transition-colors",children:"Перейти в каталог"})]}):e.jsx("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-4",children:T.map(t=>{const s=[t.image_main,...(t.additional_images||[]).map(r=>r.url)].filter(Boolean);return s.length===0&&s.push("https://placehold.co/400x400/e5e7eb/6b7280?text=No+Image"),e.jsxs(u,{href:`/product/${t.id}`,className:"bg-white rounded-2xl overflow-hidden shadow-sm group border border-gray-100 flex flex-col cursor-pointer hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"relative aspect-[2/3] overflow-hidden bg-gray-50",children:[e.jsx(J,{modules:[K,X],pagination:{clickable:!0},navigation:!0,className:"h-full w-full product-swiper",children:s.map((r,a)=>e.jsx(ee,{children:e.jsx("img",{src:r,alt:`${t.name} - ${a+1}`,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"})},a))}),t.old_price&&e.jsxs("div",{className:"absolute top-2 left-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-lg z-10",children:["-",Math.round((t.old_price-t.price)/t.old_price*100),"%"]})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm mb-1 line-clamp-2 min-h-[2.5rem]",children:t.name}),e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-yellow-500 text-sm",children:"★"}),e.jsx("span",{className:"text-xs text-gray-600",children:Number(t.reviews_avg_rating||0).toFixed(1)}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",t.reviews_count||0,")"]})]}),e.jsxs("div",{className:"flex items-end gap-2 mb-3",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[new Intl.NumberFormat("ru-RU").format(t.price)," BYN"]}),t.old_price&&e.jsxs("span",{className:"text-xs text-gray-400 line-through mb-0.5",children:[new Intl.NumberFormat("ru-RU").format(t.old_price)," BYN"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:r=>V(r,t),className:"flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-colors bg-red-50 border border-red-200",children:e.jsx(c.Heart,{className:"w-5 h-5 transition-all fill-red-500 stroke-red-500"})}),(()=>{const r=$.find(a=>a.id===t.id);return r?e.jsxs("div",{className:"flex-1 flex items-center gap-1 bg-green-600 rounded-xl overflow-hidden",children:[e.jsx("button",{onClick:a=>Z(a,t.id),className:"w-10 h-10 flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"−"}),e.jsx("div",{className:"flex-1 text-center text-white font-bold text-sm",children:r.quantity}),e.jsx("button",{onClick:a=>z(a,t.id),className:"w-10 h-10 flex items-center justify-center hover:bg-green-700 transition-colors text-white font-bold text-lg",children:"+"})]}):e.jsx("button",{onClick:a=>U(a,t),className:`flex-1 py-2.5 rounded-xl font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${t.stock<=0?"bg-gray-200 text-gray-500":"bg-red-500 hover:bg-red-600 text-white"}`,disabled:t.stock<=0,children:t.stock>0?e.jsxs(e.Fragment,{children:[e.jsx(c.ShoppingCart,{className:"w-4 h-4"}),e.jsxs("span",{className:"text-sm",children:[e.jsx("span",{className:"xs:hidden",children:"купить"}),e.jsx("span",{className:"hidden xs:inline",children:"сегодня"})]})]}):"Нет в наличии"})})(),(()=>{const r=I.some(a=>a.id===t.id);return e.jsx("button",{onClick:a=>Y(a,t),className:`flex-shrink-0 w-10 h-10 rounded-xl flex items-center justify-center transition-colors ${r?"bg-red-50 border border-red-200":"bg-gray-100 hover:bg-gray-200"}`,children:e.jsx(c.MessageCircle,{className:`w-5 h-5 transition-all ${r?"fill-red-500 stroke-red-500":"text-gray-600"}`})})})()]})]})]},t.id)})})})})]})};export{le as default};
